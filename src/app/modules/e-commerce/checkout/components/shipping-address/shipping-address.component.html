<h2 class="text-xl font-semibold">
  Direcciones de Envío guardadas
</h2>


<div class="grid grid-cols-1 gap-4 w-full mt-3">
  @for (shipping of shippingAddresses(); track shipping.id) {
    <div
      class="border-[1.5px] p-4 rounded-lg gap-3 items-center relative hover:border-orange hover:cursor-pointer transition-all"
      [ngClass]="{
        'border-[2.5px] border-orange shadow-sm': shipping.id === shippingAddressId()
      }"
      (click)="onSelect.emit(shipping.id)"
    >
      <div class="flex items-center gap-2 justify-between w-full mb-2">
        <p>{{ shipping.address }}</p>
        <div class="flex gap-1">
          <button
            mat-icon-button
            color="primary"
            class="row-start-1"
            type="button"
            (click)="isOpen() ? close($event) : selectShippingAddress($event, shipping, 'edit')"
          >
            <mat-icon>{{ isOpen() ? 'close' : 'edit' }}</mat-icon>
          </button>

          <button
            mat-icon-button
            color="primary"
            class="row-start-1"
            type="button"
            (click)="deleteShippingAddress($event, shipping.id)"
          >
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </div>
      <div>
        <p class="text-gray-500 text-sm">{{ shipping.country }} - {{ shipping.city }}</p>
        <p class="text-sm text-gray-500">{{ shipping.userName }}</p>
      </div>
    </div>
  } @empty {
    <div class=" text-gray-500">
      <p>No tiene ninguna dirección de envío guardada. Por favor cree una nueva.</p>
    </div>
  }
</div>


@if (isOpen()) {
  <hr class="my-4" />
  <h3 class="text-md font-semibold">Nueva dirección de envío</h3>
  <form [formGroup]="formShippingAddress" (ngSubmit)="submitShippingAddress()">
    <div class="mt-2 row">
      <div class="col-12">
        <mat-form-field class="w-full">
          <mat-label>Dirección</mat-label>
          <input
            formControlName="address"
            matInput
            autocomplete="off"
            maxlength="60"
          />
        </mat-form-field>
      </div>
    </div>

    <div class="mt-2 row">
      <div class="col-12">
        <mat-form-field class="w-full">
          <mat-label>Ciudad</mat-label>
          <input
            formControlName="city"
            matInput
            autocomplete="off"
            maxlength="60"
          />
        </mat-form-field>
      </div>
    </div>

    <div class="mt-2 row">
      <div class="col-12">
        <mat-form-field class="w-full">
          <mat-label>País</mat-label>
          <input
            formControlName="country"
            matInput
            autocomplete="off"
            maxlength="60"
            [value]="'Perú'"
            readonly
            [disabled]="true"
          />
        </mat-form-field>
      </div>
    </div>

    <div class="mt-2 row">
      <div class="col-12">
        <mat-form-field class="w-full">
          <mat-label>Código Postal</mat-label>
          <input
            formControlName="zipCode"
            matInput
            autocomplete="off"
            maxlength="10"
          />
        </mat-form-field>
      </div>
    </div>

    <div class="flex justify-end gap-2">
      <button
        mat-raised-button
        mat-dialog-close="true"
        color="warn"
        type="button"
        (click)="close($event)"
      >
        Cancelar
      </button>
      <button
        mat-raised-button
        color="primary"
        [disabled]="formShippingAddress.invalid"
        type="submit"
      >
        {{ nameButton() }}
      </button>
    </div>
  </form>
} @else {
  <button
    class="flex items-end justify-center text-orange w-fit hover:cursor-pointer border-b-2 hover:border-orange border-white transition-all mt-3"
    (click)="selectShippingAddress($event, defaultShippingAddress, 'create')"
  >
    <mat-icon class="material-symbols-outlined !text-xl">add</mat-icon>
    <span class="leading-none">Añadir Direccion de Envio</span>
  </button>
}
